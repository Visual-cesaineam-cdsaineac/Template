<!doctype html><html lang=es dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Image Procesing #  En webgl (es decir, GLSL ES) la texturización se utiliza para implementar el procesamiento de imágenes.
Para dibujar imágenes en WebGL necesitamos utilizar texturas. De manera similar a la forma en que WebGL espera coordenadas de espacio de recorte cuando renderiza en lugar de píxeles, WebGL espera coordenadas de textura cuando lee una textura. Las coordenadas de la textura van de 0.0 a 1.0 sin importar las dimensiones de la textura."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Image Procesing #  En webgl (es decir, GLSL ES) la texturización se utiliza para implementar el procesamiento de imágenes.
Para dibujar imágenes en WebGL necesitamos utilizar texturas. De manera similar a la forma en que WebGL espera coordenadas de espacio de recorte cuando renderiza en lugar de píxeles, WebGL espera coordenadas de textura cuando lee una textura. Las coordenadas de la textura van de 0.0 a 1.0 sin importar las dimensiones de la textura."><meta property="og:type" content="article"><meta property="og:url" content="https://visual-cesaineam-cdsaineac.github.io/Template/docs/menu/Shaders/3._Image_Processing/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2022-06-27T23:52:15-05:00"><title>3. Image Processing | Computación visual</title><link rel=manifest href=/Template/manifest.json><link rel=icon href=/Template/favicon.png type=image/x-icon><link rel=stylesheet href=/Template/book.min.ab46de3e725a6415339a37bba23a0067534a37289b063c9f8d011515a63097a8.css integrity="sha256-q0bePnJaZBUzmje7ojoAZ1NKNyibBjyfjQEVFaYwl6g=" crossorigin=anonymous><script defer src=/Template/flexsearch.min.js></script>
<script defer src=/Template/en.search.min.fe806bbb1d6e7648541d2b24ab3dd5dc1955f2ac0cfb920d83f159dec8ba97d6.js integrity="sha256-/oBrux1udkhUHSskqz3V3BlV8qwM+5INg/FZ3si6l9Y=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/Template/><span>Computación visual</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Menu</span><ul><li><input type=checkbox id=section-a7e2d1058f355758e2aa831345cac6b5 class=toggle>
<label for=section-a7e2d1058f355758e2aa831345cac6b5 class="flex justify-between"><a href=/Template/docs/menu/ilusiones/>Ilusiones</a></label><ul><li><a href=/Template/docs/menu/ilusiones/cuadricula/>Cuadricula</a></li><li><a href=/Template/docs/menu/ilusiones/distorsi%C3%B3n/>Distorsión</a></li></ul></li><li><input type=checkbox id=section-383d134cb2a673d465faec8bf44bb1dc class=toggle>
<label for=section-383d134cb2a673d465faec8bf44bb1dc class="flex justify-between"><a href=/Template/docs/menu/integrantes/>Integrantes</a></label><ul><li><a href=/Template/docs/menu/integrantes/Cristian_David_Sainea_Cespedes/>Cristian David Sainea Cespedes</a></li><li><a href=/Template/docs/menu/integrantes/Cristian_Esteban_Sainea_Martinez/>Cristian Esteban Sainea Martinez</a></li></ul></li><li><input type=checkbox id=section-9a39f2f46eda4823e2cba823db7eced1 class=toggle>
<label for=section-9a39f2f46eda4823e2cba823db7eced1 class="flex justify-between"><a href=/Template/docs/menu/rasterizacion/>Rasterizacion</a></label><ul><li><a href=/Template/docs/menu/rasterizacion/1._Bresenham/>1. Bresenham</a></li><li><a href=/Template/docs/menu/rasterizacion/2._Xiaolin_Wu/>2. Xiaolin Wu</a></li><li><a href=/Template/docs/menu/rasterizacion/3._Interpolaci%C3%B3n/>3. Interpolación</a></li></ul></li><li><input type=checkbox id=section-3d1a13ecbec2c2118fc0226411b14b32 class=toggle checked>
<label for=section-3d1a13ecbec2c2118fc0226411b14b32 class="flex justify-between"><a href=/Template/docs/menu/Shaders/>Shaders</a></label><ul><li><a href=/Template/docs/menu/Shaders/1._Coloring/>1. Coloring</a></li><li><a href=/Template/docs/menu/Shaders/2._Texturing/>2. Texturing</a></li><li><a href=/Template/docs/menu/Shaders/3._Image_Processing/ class=active>3. Image Processing</a></li><li><a href=/Template/docs/menu/Shaders/4._Procedural_Texturing/>4. Procedural Texturing</a></li></ul></li><li><input type=checkbox id=section-625a6a98e32abe32be15c68c283410c4 class=toggle>
<label for=section-625a6a98e32abe32be15c68c283410c4 class="flex justify-between"><a href=/Template/docs/menu/Transformaciones/>Transformaciones</a></label><ul></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/Template/svg/menu.svg class=book-icon alt=Menu></label>
<strong>3. Image Processing</strong>
<label for=toc-control><img src=/Template/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#image-procesing>Image Procesing</a><ul><li><a href=#visión-nocturna>Visión nocturna</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=image-procesing>Image Procesing
<a class=anchor href=#image-procesing>#</a></h1><p>En webgl (es decir, GLSL ES) la texturización se utiliza para implementar el procesamiento de imágenes.</p><p>Para dibujar imágenes en WebGL necesitamos utilizar texturas. De manera similar a la forma en que WebGL espera coordenadas de espacio de recorte cuando renderiza en lugar de píxeles, WebGL espera coordenadas de textura cuando lee una textura. Las coordenadas de la textura van de 0.0 a 1.0 sin importar las dimensiones de la textura.</p><p>Como sólo estamos dibujando un único rectángulo (bueno, 2 triángulos) necesitamos decirle a WebGL a qué lugar de la textura corresponde cada punto del rectángulo. Pasaremos esta información desde el sombreador de vértices al sombreador de fragmentos usando un tipo especial de variable llamada &lsquo;varying&rsquo;. Se llama variable porque varía. WebGL interpolará los valores que proporcionemos en el sombreador de vértices mientras dibuja cada píxel utilizando el fragment shader.</p><iframe id=Shaders_ImageProcessing style=width:720px;height:525px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/addons/p5.sound.min.js></script>
            <script src=https://cdn.jsdelivr.net/gh/objetos/p5.quadrille.js/p5.quadrille.js></script>
            <script src=https://cdn.jsdelivr.net/gh/VisualComputing/p5.treegl/p5.treegl.js></script>
            <script src=https://cdn.jsdelivr.net/gh/freshfork/p5.EasyCam@1.2.1/p5.easycam.js></script>
            <script src=https://samiare.github.io/Controller.js/js/Controller.js></script>
            <script src=https://samiare.github.io/Controller.js/js/Controller.layouts.js></script>
            
            
            
            
            
            <script src=/Template/sketches/Shaders_ImageProcessing.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe><p>Por ejemplo, el siguiente shader implementa una matriz de convolución 3x3 bastante genérica, a la cual se le aplica la operacion de Ridge detection la cual esta denotada de la siguiente forma</p><figure><img src=https://media.geeksforgeeks.org/wp-content/uploads/20200404165157/laplacian-operator.png width=300 height=300></figure><details><summary>Shaders_ImageProcessing.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lumaShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>video</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#39;/Template/sketches/shaders/mask.frag&#39;</span>, {<span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>NONE</span>});
</span></span><span style=display:flex><span>  <span style=color:#75715e>// image source: https://en.wikipedia.org/wiki/HSL_and_HSV#/media/File:Fire_breathing_2_Luc_Viatour.jpg
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#39;/Template/sketches/shaders/fire_breathing.jpg&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>700</span>, <span style=color:#ae81ff>500</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>lumaShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texture&#39;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texOffset&#39;</span>, [<span style=color:#ae81ff>0.001</span>,<span style=color:#ae81ff>0.001</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;mask&#39;</span>, [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>8.0</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>,<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;mouse_position&#39;</span>, [<span style=color:#a6e22e>mouseX</span>,<span style=color:#a6e22e>mouseY</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*beginShape();
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(1, -1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(-1, -1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(-1, 1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(1, 1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>  endShape(CLOSE);*/</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;1&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;filter_selected&#39;</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;filter_selected&#39;</span>, <span style=color:#ae81ff>2.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;mouse_position&#39;</span>, [<span style=color:#a6e22e>mouseX</span>,<span style=color:#a6e22e>mouseY</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><details><summary>mask.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl><span style=display:flex><span><span style=color:#66d9ef>precision</span> <span style=color:#66d9ef>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// uniforms are defined and sent by the sketch</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>bool</span> grey_scale;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>sampler2D</span> texture;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>vec2</span> mouse_position;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>float</span> filter_selected;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>vec2</span> u_resolution;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>vec2</span> texOffset;
</span></span><span style=display:flex><span><span style=color:#75715e>// holds the 3x3 kernel</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>float</span> mask[<span style=color:#ae81ff>9</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// interpolated texcoord (same name and type as in vertex shader)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>varying</span> <span style=color:#66d9ef>vec2</span> texcoords2;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>float</span> luma(<span style=color:#66d9ef>vec3</span> texel) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0.299</span> <span style=color:#f92672>*</span> texel.r <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.587</span> <span style=color:#f92672>*</span> texel.g <span style=color:#f92672>+</span> <span style=color:#ae81ff>0.114</span> <span style=color:#f92672>*</span> texel.b;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// returns luma of given texel</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>vec3</span> luminance() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec4</span> color <span style=color:#f92672>=</span> texture2D(texture, texcoords2);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> st <span style=color:#f92672>=</span> gl_FragCoord.xy; 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> mouse <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec2</span>(mouse_position.x, <span style=color:#ae81ff>500.0</span> <span style=color:#f92672>-</span> mouse_position.y);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*if(st.x &lt;= mouse.x + 100.0 &amp;&amp; 
</span></span></span><span style=display:flex><span><span style=color:#75715e>    st.x &gt; mouse.x - 100.0 &amp;&amp; 
</span></span></span><span style=display:flex><span><span style=color:#75715e>    500.0 - st.y &lt;=  mouse.y + 100.0 &amp;&amp;
</span></span></span><span style=display:flex><span><span style=color:#75715e>    500.0 - st.y &gt; mouse.y - 100.0){
</span></span></span><span style=display:flex><span><span style=color:#75715e>      r = 0.0;
</span></span></span><span style=display:flex><span><span style=color:#75715e>      g = dot(color.rgb, vec3(0.2126, 0.7152, 0.0722));
</span></span></span><span style=display:flex><span><span style=color:#75715e>      b = 0.0;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  }*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(distance(st,mouse)<span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>90.0</span>){
</span></span><span style=display:flex><span>     <span style=color:#75715e>// 1. Use offset to move along texture space.</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// In this case to find the texcoords of the texel neighbours.</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc0 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(<span style=color:#f92672>-</span>texOffset.s, <span style=color:#f92672>-</span>texOffset.t);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc1 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(         <span style=color:#ae81ff>0.0</span>, <span style=color:#f92672>-</span>texOffset.t);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc2 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(<span style=color:#f92672>+</span>texOffset.s, <span style=color:#f92672>-</span>texOffset.t);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc3 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(<span style=color:#f92672>-</span>texOffset.s,          <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// origin (current fragment texcoords)</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc4 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(         <span style=color:#ae81ff>0.0</span>,          <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc5 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(<span style=color:#f92672>+</span>texOffset.s,          <span style=color:#ae81ff>0.0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc6 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(<span style=color:#f92672>-</span>texOffset.s, <span style=color:#f92672>+</span>texOffset.t);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc7 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(         <span style=color:#ae81ff>0.0</span>, <span style=color:#f92672>+</span>texOffset.t);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> tc8 <span style=color:#f92672>=</span> texcoords2 <span style=color:#f92672>+</span> <span style=color:#66d9ef>vec2</span>(<span style=color:#f92672>+</span>texOffset.s, <span style=color:#f92672>+</span>texOffset.t);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 2. Sample texel neighbours within the rgba array</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec4</span> rgba[<span style=color:#ae81ff>9</span>];
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>=</span> texture2D(texture, tc0);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> texture2D(texture, tc1);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>2</span>] <span style=color:#f92672>=</span> texture2D(texture, tc2);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> texture2D(texture, tc3);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>4</span>] <span style=color:#f92672>=</span> texture2D(texture, tc4);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>=</span> texture2D(texture, tc5);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>6</span>] <span style=color:#f92672>=</span> texture2D(texture, tc6);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>7</span>] <span style=color:#f92672>=</span> texture2D(texture, tc7);
</span></span><span style=display:flex><span>  rgba[<span style=color:#ae81ff>8</span>] <span style=color:#f92672>=</span> texture2D(texture, tc8);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 3. Apply convolution kernel</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec4</span> convolution;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    convolution <span style=color:#f92672>+=</span> rgba[i]<span style=color:#f92672>*</span>mask[i];
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(filter_selected <span style=color:#f92672>==</span> <span style=color:#ae81ff>1.0</span>){
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>return</span> convolution.rgb;
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(filter_selected <span style=color:#f92672>==</span> <span style=color:#ae81ff>2.0</span>){
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> (<span style=color:#66d9ef>vec3</span>(luma(color.rgb)));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec4</span> color <span style=color:#f92672>=</span> texture2D(texture, texcoords2);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> r <span style=color:#f92672>=</span> color.r;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> g <span style=color:#f92672>=</span> color.g;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> b <span style=color:#f92672>=</span> color.b;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (<span style=color:#66d9ef>vec3</span>(r,g,b));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> main() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// texture2D(texture, texcoords2) samples texture at texcoords2 </span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// and returns the normalized texel color</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*vec4 texel = texture2D(texture, texcoords2);
</span></span></span><span style=display:flex><span><span style=color:#75715e>  gl_FragColor = vec4(luminance(texel.rgb), 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>  gl_FragColor = vec4(luminance(), 1.0);
</span></span></span><span style=display:flex><span><span style=color:#75715e>  */</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>   
</span></span><span style=display:flex><span>    gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(luminance(), <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><h2 id=visión-nocturna>Visión nocturna
<a class=anchor href=#visi%c3%b3n-nocturna>#</a></h2><p>Como ejercicio adicional, implementamos un shader que simula la vision nocturna a través de una Lupa, adicionalmente usa las herramientas de brillo de HSV, HSL y Luma.</p><p>La implementación se realizó tanto para una imagen, como para un video</p><ul><li>Al oprimir el número &ldquo;1&rdquo; se aplica la herramienta de color luma</li><li>Al oprimir el número &ldquo;2&rdquo; se aplica la herramienta de color HSV</li><li>Al oprimir el número &ldquo;3&rdquo; se aplica la herramienta de color HSL</li><li>El efecto de lupa, cambio de color y herramienta de brillo se aplica a la región circular que tiene como centro la posición del mouse</li><li>El selector en la parte superior cambiará el recurso de entrada, ya sea la imagen o el video</li></ul><iframe id=Shaders_Playground style=width:720px;height:525px srcdoc="
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/addons/p5.sound.min.js></script>
            <script src=https://cdn.jsdelivr.net/gh/objetos/p5.quadrille.js/p5.quadrille.js></script>
            <script src=https://cdn.jsdelivr.net/gh/VisualComputing/p5.treegl/p5.treegl.js></script>
            <script src=https://cdn.jsdelivr.net/gh/freshfork/p5.EasyCam@1.2.1/p5.easycam.js></script>
            <script src=https://samiare.github.io/Controller.js/js/Controller.js></script>
            <script src=https://samiare.github.io/Controller.js/js/Controller.layouts.js></script>
            
            
            
            
            
            <script src=/Template/sketches/Shaders_Playground.js></script>
          </head>
          <body>
          </body>
        </html>
      "></iframe>
<details><summary>Shaders_Night_Vision.js</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lumaShader</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>img</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>selector</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>vid</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>preload</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>readShader</span>(<span style=color:#e6db74>&#39;/Template/sketches/shaders/playground.frag&#39;</span>, {<span style=color:#a6e22e>matrices</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Tree</span>.<span style=color:#a6e22e>NONE</span>});
</span></span><span style=display:flex><span>  <span style=color:#75715e>// image source: https://en.wikipedia.org/wiki/HSL_and_HSV#/media/File:Fire_breathing_2_Luc_Viatour.jpg
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>loadImage</span>(<span style=color:#e6db74>&#39;/Template/sketches/shaders/night.jpg&#39;</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vid</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createVideo</span>(<span style=color:#e6db74>&#34;/Template/sketches/shaders/videotest.mp4&#34;</span>,<span style=color:#a6e22e>vidLoad</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>createCanvas</span>(<span style=color:#ae81ff>700</span>, <span style=color:#ae81ff>500</span>, <span style=color:#a6e22e>WEBGL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>noStroke</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>textureMode</span>(<span style=color:#a6e22e>NORMAL</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>shader</span>(<span style=color:#a6e22e>lumaShader</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texture&#39;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>createCheckbox</span>(<span style=color:#e6db74>&#39;video&#39;</span>,<span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span>.<span style=color:#a6e22e>position</span>(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span>.<span style=color:#a6e22e>style</span>(<span style=color:#e6db74>&#39;color&#39;</span>, <span style=color:#e6db74>&#39;white&#39;</span>);  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>selector</span>.<span style=color:#a6e22e>changed</span>(<span style=color:#a6e22e>SelectorEvent</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>SelectorEvent</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selector</span>.<span style=color:#a6e22e>checked</span>()) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texture&#39;</span>, <span style=color:#a6e22e>vid</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>vidLoad</span>();
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;texture&#39;</span>, <span style=color:#a6e22e>img</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>vidLoad</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vid</span>.<span style=color:#a6e22e>loop</span>();
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vid</span>.<span style=color:#a6e22e>speed</span>(<span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vid</span>.<span style=color:#a6e22e>volume</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>vid</span>.<span style=color:#a6e22e>hide</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>draw</span>() {
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;mouse_position&#39;</span>, [<span style=color:#a6e22e>mouseX</span>,<span style=color:#a6e22e>mouseY</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*beginShape();
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(1, -1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(-1, -1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(-1, 1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>    vertex(1, 1);
</span></span></span><span style=display:flex><span><span style=color:#75715e>  endShape(CLOSE);*/</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>keyPressed</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;1&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;filter_selected&#39;</span>, <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;filter_selected&#39;</span>, <span style=color:#ae81ff>2.0</span>);
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>key</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;3&#39;</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;filter_selected&#39;</span>, <span style=color:#ae81ff>3.0</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>background</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lumaShader</span>.<span style=color:#a6e22e>setUniform</span>(<span style=color:#e6db74>&#39;mouse_position&#39;</span>, [<span style=color:#a6e22e>mouseX</span>,<span style=color:#a6e22e>mouseY</span>]);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>quad</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details><details><summary>night_vision.frag</summary><div class=markdown-inner><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-glsl data-lang=glsl><span style=display:flex><span><span style=color:#66d9ef>precision</span> <span style=color:#66d9ef>mediump</span> <span style=color:#66d9ef>float</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// uniforms are defined and sent by the sketch</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>bool</span> grey_scale;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>sampler2D</span> texture;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>vec2</span> mouse_position;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>float</span> filter_selected;
</span></span><span style=display:flex><span><span style=color:#66d9ef>uniform</span> <span style=color:#66d9ef>vec2</span> u_resolution;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// interpolated texcoord (same name and type as in vertex shader)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>varying</span> <span style=color:#66d9ef>vec2</span> texcoords2;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// returns luma of given texel</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>vec3</span> luminance() {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec4</span> color <span style=color:#f92672>=</span> texture2D(texture, texcoords2);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> st <span style=color:#f92672>=</span> gl_FragCoord.xy; 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>vec2</span> mouse <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec2</span>(mouse_position.x, <span style=color:#ae81ff>500.0</span> <span style=color:#f92672>-</span> mouse_position.y);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*if(st.x &lt;= mouse.x + 100.0 &amp;&amp; 
</span></span></span><span style=display:flex><span><span style=color:#75715e>    st.x &gt; mouse.x - 100.0 &amp;&amp; 
</span></span></span><span style=display:flex><span><span style=color:#75715e>    500.0 - st.y &lt;=  mouse.y + 100.0 &amp;&amp;
</span></span></span><span style=display:flex><span><span style=color:#75715e>    500.0 - st.y &gt; mouse.y - 100.0){
</span></span></span><span style=display:flex><span><span style=color:#75715e>      r = 0.0;
</span></span></span><span style=display:flex><span><span style=color:#75715e>      g = dot(color.rgb, vec3(0.2126, 0.7152, 0.0722));
</span></span></span><span style=display:flex><span><span style=color:#75715e>      b = 0.0;
</span></span></span><span style=display:flex><span><span style=color:#75715e>  }*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(distance(st,mouse)<span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>150.0</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec4</span> color <span style=color:#f92672>=</span> texture2D(texture, <span style=color:#66d9ef>vec2</span>((<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span> mouse.x<span style=color:#f92672>/</span><span style=color:#ae81ff>700.0</span>) <span style=color:#f92672>+</span> (texcoords2.x <span style=color:#f92672>-</span> mouse.x<span style=color:#f92672>/</span><span style=color:#ae81ff>700.0</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>0.4</span>,(<span style=color:#ae81ff>1.0</span><span style=color:#f92672>-</span> mouse.y<span style=color:#f92672>/</span><span style=color:#ae81ff>500.0</span>) <span style=color:#f92672>+</span> (texcoords2.y <span style=color:#f92672>-</span> mouse.y<span style=color:#f92672>/</span><span style=color:#ae81ff>500.0</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>0.4</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> r <span style=color:#f92672>=</span> color.r;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> g <span style=color:#f92672>=</span> color.g;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> b <span style=color:#f92672>=</span> color.b;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> Cmax <span style=color:#f92672>=</span> max(r,max(g,b)); 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> Cmin <span style=color:#f92672>=</span> min(r,min(g,b));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> V;
</span></span><span style=display:flex><span>     
</span></span><span style=display:flex><span>    <span style=color:#75715e>// HSV </span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (filter_selected <span style=color:#f92672>==</span> <span style=color:#ae81ff>2.0</span>){
</span></span><span style=display:flex><span>      V <span style=color:#f92672>=</span> Cmax;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>//HSL</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (filter_selected <span style=color:#f92672>==</span> <span style=color:#ae81ff>3.0</span>){
</span></span><span style=display:flex><span>      V <span style=color:#f92672>=</span> (Cmax <span style=color:#f92672>+</span> Cmin) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2.0</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// luma by default</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>      V <span style=color:#f92672>=</span> dot(color.rgb, <span style=color:#66d9ef>vec3</span>(<span style=color:#ae81ff>0.299</span>, <span style=color:#ae81ff>0.587</span>, <span style=color:#ae81ff>0.0114</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec3</span> result <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec3</span>(V);
</span></span><span style=display:flex><span>    result.r <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    result.b <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }<span style=color:#66d9ef>else</span>{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>vec4</span> color <span style=color:#f92672>=</span> texture2D(texture, texcoords2);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> r <span style=color:#f92672>=</span> color.r;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> g <span style=color:#f92672>=</span> color.g;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>float</span> b <span style=color:#f92672>=</span> color.b;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> (<span style=color:#66d9ef>vec3</span>(r,g,b));
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> main() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// texture2D(texture, texcoords2) samples texture at texcoords2 </span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// and returns the normalized texel color</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>/*vec4 texel = texture2D(texture, texcoords2);
</span></span></span><span style=display:flex><span><span style=color:#75715e>  gl_FragColor = vec4(luminance(texel.rgb), 1.0);*/</span>
</span></span><span style=display:flex><span>  gl_FragColor <span style=color:#f92672>=</span> <span style=color:#66d9ef>vec4</span>(luminance(), <span style=color:#ae81ff>1.0</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></details></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/Visual-cesaineam-cdsaineac/Template/commit/4ff49a471208a3285561892d43e5dd4b25e888a3 title="Last modified by Cristian | June 28, 2022" target=_blank rel=noopener><img src=/Template/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 28, 2022</span></a></div></div><script>(function(){function e(n){const e=window.getSelection(),t=document.createRange();t.selectNodeContents(n),e.removeAllRanges(),e.addRange(t)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#image-procesing>Image Procesing</a><ul><li><a href=#visión-nocturna>Visión nocturna</a></li></ul></li></ul></nav></div></aside></main></body></html>